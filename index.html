@@ -1,23 +1,18 @@
<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Система логістики</title>
  <!-- Підключення Bootstrap -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Підключення зовнішнього файлу стилів -->
  <link rel="stylesheet" href="style.css">
  <!-- Підключення jsPDF та SheetJS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
  
<link rel="stylesheet" href="style.css">
<style>
   .tab-section { display: none; }
   .tab-section.active { display: block; }
</style>

  
    /* Стилі для навігації та секцій */
  <style>
    /* Додаткові стилі для секцій */
    .tab-section { display: none; }
    .tab-section.active { display: block; }
  </style>
@@ -84,10 +79,10 @@
          </tr>
        </thead>
        <tbody>
          <!-- Дані завантажуватимуться динамічно -->
          <!-- Дані замовлень завантажуватимуться динамічно -->
        </tbody>
      </table>
      <!-- Кнопка завантаження замовлень (за бажанням) -->
      <!-- Кнопка завантаження замовлень (опціонально) -->
      <button class="btn btn-success" id="loadOrders">Завантажити замовлення</button>
      <hr>
      <!-- Форма для додавання/редагування замовлення -->
@@ -120,164 +115,57 @@
        </div>
      </form>
    </section>
    
 
  <table class="table table-bordered" id="transportTable">
    <thead>
      <tr>
        <th>ID</th>
        <th>Марка</th>
        <th>Модель</th>
        <th>Рік</th>
        <th>Номер</th>
        <th>Дії</th>
      </tr>
    </thead>
    <tbody>
      <!-- Дані додаються через JS -->
    </tbody>
  </table>

  <!-- Форма -->
  <h3>Додати/Редагувати транспорт</h3>
  <form id="transportForm" class="row g-3">
    <div class="col-md-4">
      <label for="vehicleId" class="form-label">ID ТЗ</label>
      <input type="text" id="vehicleId" class="form-control" required>
    </div>
    <div class="col-md-4">
      <label for="vehicleBrand" class="form-label">Марка</label>
      <input type="text" id="vehicleBrand" class="form-control" required>
    </div>
    <div class="col-md-4">
      <label for="vehicleModel" class="form-label">Модель</label>
      <input type="text" id="vehicleModel" class="form-control" required>
    </div>
    <div class="col-md-4">
      <label for="vehicleYear" class="form-label">Рік випуску</label>
      <input type="number" id="vehicleYear" class="form-control" required>
    </div>
    <div class="col-md-4">
      <label for="vehicleNumber" class="form-label">Номерний знак</label>
      <input type="text" id="vehicleNumber" class="form-control" required>
    </div>
    <div class="col-12">
      <button type="submit" class="btn btn-primary">Зберегти</button>
      <p id="transportMessage" class="mt-2 text-success"></p>
    </div>
  </form>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    let editingVehicleId = null;

    const transportElements = {
      form: document.getElementById('transportForm'),
      message: document.getElementById('transportMessage'),
      tableBody: document.querySelector('#transportTable tbody')
    };

    function getTransportList() {
      return JSON.parse(localStorage.getItem('transport')) || [];
    }

    function saveTransportList(data) {
      localStorage.setItem('transport', JSON.stringify(data));
    }

    function renderTransport() {
      const transportList = getTransportList();
      transportElements.tableBody.innerHTML = '';

      if (transportList.length === 0) {
        transportElements.tableBody.innerHTML =
          `<tr><td colspan="6" class="text-center fst-italic">Немає транспортних засобів</td></tr>`;
        return;
      }

      transportList.forEach(vehicle => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${vehicle.id}</td>
          <td>${vehicle.brand}</td>
          <td>${vehicle.model}</td>
          <td>${vehicle.year}</td>
          <td>${vehicle.number}</td>
          <td>
            <button class="btn btn-sm btn-warning edit-vehicle">Редагувати</button>
            <button class="btn btn-sm btn-danger delete-vehicle">Видалити</button>
          </td>
        `;
        transportElements.tableBody.appendChild(row);

        // Редагування
        row.querySelector('.edit-vehicle').addEventListener('click', () => {
          document.getElementById('vehicleId').value = vehicle.id;
          document.getElementById('vehicleBrand').value = vehicle.brand;
          document.getElementById('vehicleModel').value = vehicle.model;
          document.getElementById('vehicleYear').value = vehicle.year;
          document.getElementById('vehicleNumber').value = vehicle.number;
          editingVehicleId = vehicle.id;
          transportElements.message.textContent = 'Редагування транспорту...';
        });

        // Видалення
        row.querySelector('.delete-vehicle').addEventListener('click', () => {
          if (confirm('Ви дійсно хочете видалити цей транспорт?')) {
            const updatedList = getTransportList().filter(v => v.id !== vehicle.id);
            saveTransportList(updatedList);
            renderTransport();
            transportElements.message.textContent = 'Транспорт видалено!';
            if (editingVehicleId === vehicle.id) {
              editingVehicleId = null;
              transportElements.form.reset();
            }
          }
        });
      });
    }

    // Обробка форми
    transportElements.form.addEventListener('submit', (e) => {
      e.preventDefault();
      const vehicle = {
        id: document.getElementById('vehicleId').value.trim(),
        brand: document.getElementById('vehicleBrand').value.trim(),
        model: document.getElementById('vehicleModel').value.trim(),
        year: document.getElementById('vehicleYear').value.trim(),
        number: document.getElementById('vehicleNumber').value.trim()
      };

      if (!vehicle.id || !vehicle.brand || !vehicle.model || !vehicle.year || !vehicle.number) {
        alert('Будь ласка, заповніть усі поля транспорту.');
        return;
      }

      let transportList = getTransportList();

      if (editingVehicleId) {
        transportList = transportList.map(v => v.id === editingVehicleId ? vehicle : v);
        transportElements.message.textContent = 'Дані транспорту оновлено!';
        editingVehicleId = null;
      } else {
        if (transportList.some(v => v.id === vehicle.id)) {
          alert('Транспорт з таким ID вже існує!');
          return;
        }
        transportList.push(vehicle);
        transportElements.message.textContent = 'Транспорт додано!';
      }

      saveTransportList(transportList);
      renderTransport();
      transportElements.form.reset();
    });

    renderTransport();
  });
</script>

    <!-- Транспорт -->
    <section id="transport" class="tab-section">
      <h2>Транспорт</h2>
      <p>Система для управління транспортними засобами. Ви можете додавати, редагувати та видаляти транспорт.</p>
      <!-- Таблиця транспорту -->
      <table class="table table-bordered" id="transportTable">
        <thead>
          <tr>
            <th>ID ТЗ</th>
            <th>Марка</th>
            <th>Модель</th>
            <th>Рік</th>
            <th>Номер</th>
            <th>Дії</th>
          </tr>
        </thead>
        <tbody>
          <!-- Дані транспорту завантажуватимуться динамічно -->
        </tbody>
      </table>
      <hr>
      <!-- Форма для додавання/редагування транспорту -->
      <h3 id="transportFormTitle">Додати/Редагувати транспорт</h3>
      <form id="transportForm" class="row g-3">
        <div class="col-md-4">
          <label for="vehicleId" class="form-label">ID ТЗ</label>
          <input type="text" id="vehicleId" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label for="vehicleBrand" class="form-label">Марка</label>
          <input type="text" id="vehicleBrand" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label for="vehicleModel" class="form-label">Модель</label>
          <input type="text" id="vehicleModel" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label for="vehicleYear" class="form-label">Рік випуску</label>
          <input type="number" id="vehicleYear" class="form-control" required>
        </div>
        <div class="col-md-4">
          <label for="vehicleNumber" class="form-label">Номерний знак</label>
          <input type="text" id="vehicleNumber" class="form-control" required>
        </div>
        <div class="col-12">
          <button type="submit" class="btn btn-primary">Зберегти</button>
          <p id="transportMessage" class="mt-2 text-success"></p>
        </div>
      </form>
    </section>

    <!-- Працівники -->
    <section id="employees" class="tab-section">

        excelBtn: document.getElementById('download-excel-btn'),
        genReportBtn: document.getElementById('generate-report-btn')
      };
      
      // Отримання та збереження замовлень у localStorage

      function getOrders() {
        return JSON.parse(localStorage.getItem('orders')) || [];
      }
      function saveOrders(orders) {
        localStorage.setItem('orders', JSON.stringify(orders));
      }

      // Відмалювання таблиці замовлень
      function renderOrders() {
        const orders = getOrders();
        elements.ordersTableBody.innerHTML = '';
        if (orders.length === 0) {
          const row = document.createElement('tr');
          row.innerHTML = `<td colspan="5" class="text-center fst-italic">Замовлень немає</td>`;
          elements.ordersTableBody.appendChild(row);
          return;
        }
        orders.forEach(order => {
          const row = document.createElement('tr');
          row.innerHTML = `
            <td>${order.id}</td>
            <td>${order.date}</td>
            <td>${parseFloat(order.amount).toFixed(2)}</td>
            <td>${order.status}</td>
            <td>
              <button class="edit-btn btn btn-sm btn-warning">Редагувати</button>
              <button class="delete-btn btn btn-sm btn-danger">Видалити</button>
            </td>
          `;
          elements.ordersTableBody.appendChild(row);
          // Редагування замовлення
          row.querySelector('.edit-btn').addEventListener('click', () => {
            document.getElementById('orderId').value = order.id;
            document.getElementById('orderDate').value = order.date;
            document.getElementById('orderAmount').value = order.amount;
            document.getElementById('orderStatus').value = order.status;
            editingOrderId = order.id;
            elements.orderMessage.textContent = 'Редагування замовлення...';
          });
          // Видалення замовлення
          row.querySelector('.delete-btn').addEventListener('click', () => {
            if (confirm('Ви дійсно хочете видалити це замовлення?')) {
              let ordersUpdated = getOrders().filter(o => o.id !== order.id);
              saveOrders(ordersUpdated);
              renderOrders();
              elements.orderMessage.textContent = 'Замовлення видалено!';
              if (editingOrderId === order.id) {
                editingOrderId = null;
                elements.orderForm.reset();
              }
            }
          });
        });
      }
      
      // Обробка форми додавання/редагування замовлення
      elements.orderForm.addEventListener('submit', (e) => {
        e.preventDefault();
        const orderData = {
          id: document.getElementById('orderId').value.trim(),
          date: document.getElementById('orderDate').value,
          amount: document.getElementById('orderAmount').value,
          status: document.getElementById('orderStatus').value
        };
        if (!orderData.id || !orderData.date || !orderData.amount || !orderData.status) {
          alert('Будь ласка, заповніть усі поля замовлення.');
          return;
        }
        let orders = getOrders();
        if(editingOrderId) {
          if(editingOrderId !== orderData.id && orders.some(o => o.id === orderData.id)) {
            alert('Замовлення з таким ID вже існує!');
            return;
          }
          orders = orders.map(o => o.id === editingOrderId ? orderData : o);
          elements.orderMessage.textContent = 'Замовлення оновлено!';
          editingOrderId = null;
        } else {
          if(orders.some(o => o.id === orderData.id)) {
            alert('Замовлення з таким ID вже існує!');
            return;
          }
          orders.push(orderData);
          elements.orderMessage.textContent = 'Замовлення додано!';
        }
        saveOrders(orders);
        renderOrders();
        e.target.reset();
      });
      
      /* --- Генерація звітів --- */
      function generatePdfReport(reportData) {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        doc.setFontSize(14);
        doc.text('Звіт — Кількість замовлень по працівниках', 10, 10);
        let y = 20;
        reportData.forEach(item => {
          doc.text(`${item.name}: ${item.orders}`, 10, y);
          y += 10;
        });
        doc.save('report.pdf');
      }
      
      elements.genReportBtn.addEventListener('click', () => {
        // Якщо у localStorage немає даних про співробітників, створюємо тестовий набір
        let employees = JSON.parse(localStorage.getItem('employees'));
        if (!employees || employees.length === 0) {
          employees = [
            { id: "emp1", name: "Іваненко І.І." },
            { id: "emp2", name: "Петренко П.П." },
            { id: "emp3", name: "Сидоров С.С." }
          ];
          localStorage.setItem('employees', JSON.stringify(employees));
        }
        const orders = getOrders();
        const report = employees.map(emp => {
          const count = orders.filter(o => o.employeeId === emp.id).length;
          return { name: emp.name, orders: count };
        });
        elements.reportContainer.innerHTML = `
          <table class="table table-bordered">
            <thead>
              <tr><th>Працівник</th><th>Замовлень</th></tr>
            </thead>
            <tbody>
              ${report.map(item => `<tr><td>${item.name}</td><td>${item.orders}</td></tr>`).join('')}
            </tbody>
          </table>
        `;
        // Формуємо CSV
        const csvContent = [
          ['Працівник', 'Замовлень'],
          ...report.map(item => [item.name, item.orders])
        ].map(row => row.join(',')).join('\n');
        elements.reportContainer.dataset.csv = csvContent;
        elements.reportContainer.dataset.json = JSON.stringify(report);
        [elements.csvBtn, elements.pdfBtn, elements.excelBtn].forEach(btn => {
          btn.style.display = 'inline-block';
        });
      });
      
      // Експорт CSV-звіту
      elements.csvBtn.addEventListener('click', () => {
        const csv = elements.reportContainer.dataset.csv;
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = 'report.csv';
        a.click();
        URL.revokeObjectURL(url);
      });
      
      // Експорт PDF-звіту
      elements.pdfBtn.addEventListener('click', () => {
        const reportData = JSON.parse(elements.reportContainer.dataset.json);
        generatePdfReport(reportData);
      });
      
      // Експорт Excel-звіту
      elements.excelBtn.addEventListener('click', () => {
        const reportData = JSON.parse(elements.reportContainer.dataset.json);
        const ws = XLSX.utils.json_to_sheet(reportData);
        const wb = XLSX.utils.book_new();
        XLSX.utils.book_append_sheet(wb, ws, 'Звіт');
        XLSX.writeFile(wb, 'report.xlsx');
      });
      
      /* --- Навігація між секціями --- */
      const navLinks = document.querySelectorAll('nav a[data-section]');
      const tabSections = document.querySelectorAll('.tab-section');
      navLinks.forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          navLinks.forEach(nav => nav.classList.remove('active'));
          tabSections.forEach(sec => sec.classList.remove('active'));
          link.classList.add('active');
          const sectionId = link.getAttribute('data-section');
          document.getElementById(sectionId).classList.add('active');
        });Add commentMore actions
      });
      
      // Початкове відображення замовлень
      renderOrders();
    });
  </script>
</body>
</html>
